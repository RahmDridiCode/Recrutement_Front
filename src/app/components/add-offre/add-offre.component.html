
<app-header></app-header>

<main class="flex-1 py-16 px-4 lg:px-6 bg-background text-foreground min-h-screen">
  <div class="container mx-auto max-w-4xl">
    <div class="text-center mb-12 animate-fade-up">
      <div class="w-16 h-16 rounded-2xl bg-primary/10 flex items-center justify-center mx-auto mb-4">
        <svg class="h-8 w-8 text-primary" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M3 7V5a2 2 0 0 1 2-2h4l2 3h10a2 2 0 0 1 2 2v2"></path>
          <path d="M3 7h18v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
        </svg>
      </div>
      <h1 class="text-4xl md:text-5xl font-display font-bold mb-4">Publier une Offre</h1>
      <p class="text-lg text-muted-foreground max-w-2xl mx-auto">
        Trouvez le candidat idéal en publiant votre offre de stage sur notre plateforme.
      </p>
    </div>

    <section *ngIf="authService.isloggedIn; else loginPrompt">
      <div *ngIf="isRecruiter; else notRecruiter" class="glass p-8 rounded-2xl animate-fade-up">
        <form [formGroup]="jobOffer" (ngSubmit)="addJob()" class="space-y-6">
          <div class="grid md:grid-cols-2 gap-6">
            <div class="space-y-2">
              <label class="text-sm font-medium">Domaine <span class="text-destructive">*</span></label>
              <select formControlName="service" class="flex h-12 w-full rounded-md border border-input bg-background px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-ring"
                      [ngClass]="{'border-destructive': jobOffer.controls['service'].invalid && (jobOffer.controls['service'].touched || invalid)}">
                <option value="">Sélectionner un domaine</option>
                <option *ngFor="let domain of domains" [value]="domain">{{ domain }}</option>
              </select>
            </div>

            <div class="space-y-2">
              <label class="text-sm font-medium">Ville <span class="text-destructive">*</span></label>
              <select formControlName="ville" class="flex h-12 w-full rounded-md border border-input bg-background px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-ring"
                      [ngClass]="{'border-destructive': jobOffer.controls['ville'].invalid && (jobOffer.controls['ville'].touched || invalid)}">
                <option value="">Sélectionner une ville</option>
                <option *ngFor="let city of cities" [value]="city">{{ city }}</option>
              </select>
            </div>
          </div>

          <div class="space-y-2">
            <label class="text-sm font-medium">Adresse <span class="text-destructive">*</span></label>
            <input type="text" formControlName="address" placeholder="Adresse complète"
                   class="flex h-12 w-full rounded-md border border-input bg-background px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-ring"
                   [ngClass]="{'border-destructive': jobOffer.controls['address'].invalid && (jobOffer.controls['address'].touched || invalid)}" />
          </div>

          <div class="grid md:grid-cols-2 gap-6">
            <div class="space-y-2">
              <label class="text-sm font-medium">Date <span class="text-destructive">*</span></label>
              <input type="date" formControlName="date" class="flex h-12 w-full rounded-md border border-input bg-background px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-ring"
                     [ngClass]="{'border-destructive': jobOffer.controls['date'].invalid && (jobOffer.controls['date'].touched || invalid)}" />
            </div>
          </div>

          <div class="space-y-2">
            <label class="text-sm font-medium">Description <span class="text-destructive">*</span></label>
            <textarea formControlName="description" rows="6" placeholder="Décrivez le poste, les missions, les compétences requises..."
                      class="w-full rounded-md border border-input bg-background px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-ring resize-none"
                      [ngClass]="{'border-destructive': jobOffer.controls['description'].invalid && (jobOffer.controls['description'].touched || invalid)}"></textarea>
          </div>

          <div class="flex gap-3 pt-4">
            <button type="button" class="inline-flex items-center justify-center rounded-md border border-input px-4 py-3 text-sm font-semibold hover:bg-muted flex-1"
                    (click)="navigateHome()">
              Annuler
            </button>
            <button type="submit" class="inline-flex items-center justify-center rounded-md bg-primary px-4 py-3 text-sm font-semibold text-primary-foreground shadow hover:bg-primary/90 flex-1"
                    [disabled]="isSubmitting">
              {{ isSubmitting ? 'Publication...' : 'Publier l\'offre' }}
            </button>
          </div>
        </form>
      </div>
    </section>

    <ng-template #loginPrompt>
      <div class="glass p-8 rounded-2xl text-center animate-fade-up">
        <svg class="h-16 w-16 text-muted-foreground mx-auto mb-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="10"></circle>
          <line x1="12" y1="16" x2="12" y2="12"></line>
          <line x1="12" y1="8" x2="12.01" y2="8"></line>
        </svg>
        <h2 class="text-2xl font-display font-bold mb-2">Connexion requise</h2>
        <p class="text-muted-foreground mb-6">Vous devez être connecté en tant que recruteur pour publier une offre.</p>
        <div class="flex gap-3 justify-center">
          <button class="inline-flex items-center rounded-md border border-input px-4 py-2 text-sm font-semibold hover:bg-muted" routerLink="/login">Se connecter</button>
          <button class="inline-flex items-center rounded-md bg-primary px-4 py-2 text-sm font-semibold text-primary-foreground shadow hover:bg-primary/90" routerLink="/signup">S'inscrire</button>
        </div>
      </div>
    </ng-template>

    <ng-template #notRecruiter>
      <div class="glass p-8 rounded-2xl text-center animate-fade-up">
        <svg class="h-16 w-16 text-destructive mx-auto mb-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="10"></circle>
          <line x1="12" y1="8" x2="12" y2="12"></line>
          <line x1="12" y1="16" x2="12.01" y2="16"></line>
        </svg>
        <h2 class="text-2xl font-display font-bold mb-2">Accès réservé aux recruteurs</h2>
        <p class="text-muted-foreground mb-6">Cette page est réservée aux recruteurs. Si vous êtes un recruteur, veuillez contacter notre équipe pour activer votre compte.</p>
        <button class="inline-flex items-center rounded-md bg-primary px-4 py-2 text-sm font-semibold text-primary-foreground shadow hover:bg-primary/90" routerLink="/contact">
          Contacter l'équipe
        </button>
        <p class="text-xs text-muted-foreground mt-4">Note: Pour tester cette fonctionnalité, utilisez un compte recruteur.</p>
      </div>
    </ng-template>
  </div>
</main>

<app-footer></app-footer>
